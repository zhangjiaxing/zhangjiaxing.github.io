<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>cat ~/.zhiliao.history - web</title><link href="/" rel="alternate"></link><link href="/feeds/feeds/web.atom.xml" rel="self"></link><id>/</id><updated>2022-11-05T18:40:04+08:00</updated><subtitle>无聊就该多读书。</subtitle><entry><title>raspberry-debian10-selenium测试</title><link href="/posts/2022/11/05/raspbian10-raspios-selenium.html" rel="alternate"></link><published>2022-11-05T18:40:04+08:00</published><updated>2022-11-05T18:40:04+08:00</updated><author><name>zhiliao</name></author><id>tag:None,2022-11-05:/posts/2022/11/05/raspbian10-raspios-selenium.html</id><summary type="html">&lt;p&gt;测试环境 &lt;code&gt;Raspbian GNU/Linux 10 (buster)&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;经过搜索发现firefox的geckodriver官方不支持arm. 所以只能选择chromium浏览器.&lt;/p&gt;
&lt;h4&gt;安装依赖&lt;/h4&gt;
&lt;div class="highlight-custom"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;sudo apt install python3-selenium
sudo apt install python3-pyvirtualdisplay &lt;span class="c1"&gt;# 由于raspberry没有启动图形界面, 这个用来虚拟显示器&lt;/span&gt;
sudo apt install python3-xvfbwrapper
sudo apt install xvfb
sudo apt install chromium-browser chromium-chromedriver
sudo apt install bluealsa &lt;span class="c1"&gt;# chromium-browser 启动时会报告缺少这个包&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h4&gt;命令行启动chromium-browser测试&lt;/h4&gt;
&lt;div class="highlight-custom"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;Xvfb -ac :7 -screen &lt;span class="m"&gt;0&lt;/span&gt; 1280x1024x8 -extension RANDR -nolisten inet6 &lt;span class="p"&gt;&amp;amp;&lt;/span&gt;

&lt;span class="nb"&gt;export …&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</summary><content type="html">&lt;p&gt;测试环境 &lt;code&gt;Raspbian GNU/Linux 10 (buster)&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;经过搜索发现firefox的geckodriver官方不支持arm. 所以只能选择chromium浏览器.&lt;/p&gt;
&lt;h4&gt;安装依赖&lt;/h4&gt;
&lt;div class="highlight-custom"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;sudo apt install python3-selenium
sudo apt install python3-pyvirtualdisplay &lt;span class="c1"&gt;# 由于raspberry没有启动图形界面, 这个用来虚拟显示器&lt;/span&gt;
sudo apt install python3-xvfbwrapper
sudo apt install xvfb
sudo apt install chromium-browser chromium-chromedriver
sudo apt install bluealsa &lt;span class="c1"&gt;# chromium-browser 启动时会报告缺少这个包&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h4&gt;命令行启动chromium-browser测试&lt;/h4&gt;
&lt;div class="highlight-custom"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;Xvfb -ac :7 -screen &lt;span class="m"&gt;0&lt;/span&gt; 1280x1024x8 -extension RANDR -nolisten inet6 &lt;span class="p"&gt;&amp;amp;&lt;/span&gt;

&lt;span class="nb"&gt;export&lt;/span&gt;  &lt;span class="nv"&gt;DISPLAY&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;:7

chromium-browser

&lt;span class="c1"&gt;# 发现启动失败, 报告缺少`bluealsa`, 另外想在root用户下运行, 还需要加上`--no-sandbox`参数&lt;/span&gt;
&lt;span class="c1"&gt;# 安装上软件, 加上参数后测试, root用户ssh命令行启动chromium-browser已经不报错&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h4&gt;然后执行测试代码, 成功&lt;/h4&gt;
&lt;p&gt;python3 test.py&lt;/p&gt;
&lt;div class="highlight-custom"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;pyvirtualdisplay&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Display&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;selenium&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;webdriver&lt;/span&gt;

&lt;span class="n"&gt;display&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Display&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;visible&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1024&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;768&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="n"&gt;display&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;start&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="c1"&gt;# 开启虚拟GUI&lt;/span&gt;

&lt;span class="n"&gt;options&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;webdriver&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ChromeOptions&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;options&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_argument&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;--remote-debugging-port=9222&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;options&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_argument&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;--no-sandbox&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;chrome&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;webdriver&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Chrome&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;executable_path&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;/usr/bin/chromedriver&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;options&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;options&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;chrome&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;fullscreen_window&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;chrome&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;https://www.jd.com/&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;chrome&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;save_screenshot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;chrome_jd.png&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;chrome&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;quit&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</content><category term="web"></category><category term="linux"></category><category term="selenium"></category></entry><entry><title>代替品查询网站</title><link href="/posts/2022/09/03/alternativeto.html" rel="alternate"></link><published>2022-09-03T16:57:51+08:00</published><updated>2022-09-03T16:57:51+08:00</updated><author><name>zhiliao</name></author><id>tag:None,2022-09-03:/posts/2022/09/03/alternativeto.html</id><content type="html">&lt;p&gt;&lt;a href="https://alternativeto.net/"&gt;alternativeto&lt;/a&gt;&lt;/p&gt;</content><category term="web"></category><category term="web"></category></entry><entry><title>websocketd</title><link href="/posts/2018/05/22/websocketd.html" rel="alternate"></link><published>2018-05-22T19:43:51+08:00</published><updated>2018-05-22T19:43:51+08:00</updated><author><name>zhiliao</name></author><id>tag:None,2018-05-22:/posts/2018/05/22/websocketd.html</id><content type="html">&lt;p&gt;websocketd是一个简单的websocket代理服务。标准输入（stdin）就是 WebSocket 的输入，标准输出（stdout）就是 WebSocket 的输出。&lt;/p&gt;</content><category term="web"></category><category term="web"></category><category term="command"></category></entry></feed>